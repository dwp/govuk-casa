include:
  - project: dwp/engineering/gitlab-ci-toolbox
    ref: 3.x.x
    file: blueprints/node.yml

variables:
  NODE_IMAGE: node:10.18.1-alpine@sha256:60f531bebdb8023a1ecdcbb4ea5658eb499c1c71b4255ccbddf2d0277c947f93

# ---------------------------------------------------------- blueprint overrides 

# The unit tests rely on sources in dist/, and the `prepare` npm script will
# throw a "cannot run in wd" failure due to permissions (in the blueprint,
# `npm ci` is run as root, so we either need `--unsafe-perm` or run manually).
# So we run that manually.
node-modules:
  after_script:
    - npm run prepare
  artifacts:
    expire_in: 1 day
    paths:
      - artifact.tgz
      - node_modules/
      - dist/
